import{r as i,j as o,F as p,B as k}from"./index-DdTZBDI5.js";import{L as d}from"./ListGroup-a-V3Uw_0.js";import"./objectWithoutPropertiesLoose-DOI8zw2D.js";let u;const h=[{key:"onSearch",label:"Search Query",type:"callback",values:[],default:function(e){this.setValue(e)},setValue:function(e){this.value=e}},{key:"height",label:"Height",type:"number",values:[],default:500,setValue:function(e){this.value=e}},{key:"themeVariant",label:"Dark Theme or Light?",type:"toggle",values:["light","dark","auto"],default:"dark",setValue:function(e){this.value=e===void 0?"auto":e?"light":"dark"}},{key:"hideAutocomplete",label:"Hide AutoComplete",type:"toggle",values:[!0,!1],default:!1,setValue:function(e){this.value=e}},{key:"hideDatasourceFilter",label:"Hide Data Source?",type:"toggle",values:[!0,!1],default:!1,setValue:function(e){this.value=e}}];let r;function R({auth:e,ref:t}){const[n,s]=i.useState(void 0),[a,f]=i.useState(void 0);i.useEffect(()=>(e.hideAuth(!0),v().then(async l=>{if(l&&l.token){s({...l});const c=await x();f(c),r=l}}),()=>{e.hideAuth(!1)}),[e]),u=i.useRef(null);const m=t;return i.useImperativeHandle(m,()=>({attachRecommendations:y})),o.jsxs(o.Fragment,{children:[o.jsx("script",{async:!0,src:"https://app.glean.com/embedded-search-latest.min.js"}),o.jsx(d,{horizontal:!0,children:h.map(l=>l.type==="toggle"&&o.jsx(d.Item,{children:o.jsx(p.Check,{type:"switch",label:l.label,onClick:c=>{const g=c.currentTarget.checked;l.setValue(g),b()}})},l.key+"toggle"))}),!(n!=null&&n.token)&&o.jsx(k,{variant:"primary",style:{margin:"1em 1em 1em"},href:`/api/auth/sendtoidp?finalLocation=${encodeURIComponent(window.location.href)}`,children:" Simulate SSO Login using default OKTA Config "}),a&&o.jsxs("div",{style:{marginTop:"1em"},children:["You are logged in as ",a.name," with email - ",a.email,". Click on ",o.jsx("span",{style:{fontWeight:"bold"},children:'"Start Gleaning"'})," Button to render SDK"]}),o.jsx("div",{ref:u,style:{height:"70vh",marginBottom:"5vh",marginTop:"2vh"}})]})}function y(e,t){const n=window.GleanWebSDK;if(n){const s={};r&&(s.authMethod="token",s.authToken=r,s.backend="https://support-lab-be.glean.com",s.onAuthTokenRequired=function(a){console.log(a)}),h.forEach(a=>{s[a.key]=a.value||(typeof a.default=="function"?a.default.bind(a):a.default)}),n.renderRecommendations(u.current,s)}}function b(){const e=window.GleanWebSDK;if(e){const t={};r&&(t.authMethod="token",t.authToken=r,t.backend="https://support-lab-be.glean.com",t.onAuthTokenRequired=function(n){console.log(n)}),h.forEach(n=>{t[n.key]=n.value||(typeof n.default=="function"?n.default.bind(n):n.default)}),e.renderRecommendations(u.current,t)}}async function v(){const e=await fetch("/api/auth/getGleanToken",{method:"get",credentials:"include"});try{return await e.json()}catch(t){return console.log(t),t}}async function x(){const e=await fetch("/api/auth/whoAmI",{method:"get",credentials:"include"});try{return await e.json()}catch(t){return console.log(t),t}}export{R as default};
