import{r as a,j as n,B as l}from"./index-gsoGpVZP.js";let s,c;function w({auth:t,ref:e}){const[o,u]=a.useState(void 0),[r,h]=a.useState(void 0);a.useEffect(()=>(t.hideAuth(!0),p().then(async i=>{if(i&&i.token){u({...i});const f=await g();h(f),c=i}}),()=>{t.hideAuth(!1)}),[t]),s=a.useRef(null);const d=e;return a.useImperativeHandle(d,()=>({attachSearch:m})),n.jsxs(n.Fragment,{children:[n.jsx("script",{async:!0,src:"https://app.glean.com/embedded-search-latest.min.js"}),!(o!=null&&o.token)&&n.jsx(l,{variant:"primary",style:{margin:"1em 1em 1em"},href:`/api/auth/sendtoidp?finalLocation=${encodeURIComponent(window.location.href)}`,children:" Simulate SSO Login using default OKTA Config "}),r&&n.jsxs("div",{style:{marginTop:"1em"},children:["You are logged in as ",r.name," with email - ",r.email,". Click on ",n.jsx("span",{style:{fontWeight:"bold"},children:'"Start Gleaning"'})," Button to render SDK"]}),n.jsx(l,{variant:"primary",style:{margin:"auto",width:"100%"},ref:s,children:"Start Search"})]})}function m(){const t=window.GleanWebSDK;if(t){const e={};c&&(e.authMethod="token",e.authToken=c,e.backend="https://support-lab-be.glean.com",e.onAuthTokenRequired=function(o){console.log(o)}),t.attach(s.current,e)}}async function p(){const t=await fetch("/api/auth/getGleanToken",{method:"get",credentials:"include"});try{return await t.json()}catch(e){return console.log(e),e}}async function g(){const t=await fetch("/api/auth/whoAmI",{method:"get",credentials:"include"});try{return await t.json()}catch(e){return console.log(e),e}}export{w as default};
