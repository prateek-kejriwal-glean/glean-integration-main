import{r as i,j as o,B as f}from"./index-x4Ro_lB7.js";let l,c;function j({auth:e,ref:t}){const[a,n]=i.useState(void 0),[s,h]=i.useState(void 0);i.useEffect(()=>(e.hideAuth(!0),p().then(async r=>{if(r&&r.token){n({...r});const d=await g();h(d),c=r}}),()=>{e.hideAuth(!1)}),[e]),l=i.useRef(null);const u=t;return i.useImperativeHandle(u,()=>({attachChat:m})),o.jsxs(o.Fragment,{children:[o.jsx("script",{async:!0,src:"https://app.glean.com/embedded-search-latest.min.js"}),!(a!=null&&a.token)&&o.jsxs(f,{variant:"primary",style:{margin:"1em 1em 1em"},href:`/api/auth/sendtoidp?finalLocation=${encodeURIComponent(window.location.href)}`,children:[" ","Simulate SSO Login using default OKTA Config"," "]}),s&&o.jsxs("div",{style:{marginTop:"1em"},children:["You are logged in as ",s.name," with email -"," ",s.email,". Click on"," ",o.jsx("span",{style:{fontWeight:"bold"},children:'"Start Gleaning"'})," Button to render SDK"]}),o.jsx("div",{ref:l,style:{height:"70vh",marginBottom:"5vh"}})]})}function m(e,t){const a=window.GleanWebSDK;if(a){const n={urlsToOpenInCurrentTab:["^https://app.glean.com/*"]};c&&(n.authMethod="token",n.authToken=c,n.backend="https://support-lab-be.glean.com",n.onAuthTokenRequired=function(s){console.log(s)}),a.renderChat(l.current,n)}}async function p(){const e=await fetch("/api/auth/getGleanToken",{method:"get",credentials:"include"});try{return await e.json()}catch(t){return console.log(t),t}}async function g(){const e=await fetch("/api/auth/whoAmI",{method:"get",credentials:"include"});try{return await e.json()}catch(t){return console.log(t),t}}export{j as default};
