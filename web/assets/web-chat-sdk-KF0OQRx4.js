import{r as s,j as o,B as f}from"./index-DdTZBDI5.js";let c,l;function j({auth:e,ref:t}){const[a,n]=s.useState(void 0),[i,h]=s.useState(void 0);s.useEffect(()=>(e.hideAuth(!0),p().then(async r=>{if(r&&r.token){n({...r});const d=await g();h(d),l=r}}),()=>{e.hideAuth(!1)}),[e]),c=s.useRef(null);const u=t;return s.useImperativeHandle(u,()=>({attachChat:m})),o.jsxs(o.Fragment,{children:[o.jsx("script",{async:!0,src:"https://app.glean.com/embedded-search-latest.min.js"}),!(a!=null&&a.token)&&o.jsx(f,{variant:"primary",style:{margin:"1em 1em 1em"},href:`/api/auth/sendtoidp?finalLocation=${encodeURIComponent(window.location.href)}`,children:" Simulate SSO Login using default OKTA Config "}),i&&o.jsxs("div",{style:{marginTop:"1em"},children:["You are logged in as ",i.name," with email - ",i.email,". Click on ",o.jsx("span",{style:{fontWeight:"bold"},children:'"Start Gleaning"'})," Button to render SDK"]}),o.jsx("div",{ref:c,style:{height:"70vh",marginBottom:"5vh"}})]})}function m(e,t){const a=window.GleanWebSDK;if(a){const n={};l&&(n.authMethod="token",n.authToken=l,n.backend="https://support-lab-be.glean.com",n.onAuthTokenRequired=function(i){console.log(i)}),a.renderChat(c.current,n)}}async function p(){const e=await fetch("/api/auth/getGleanToken",{method:"get",credentials:"include"});try{return await e.json()}catch(t){return console.log(t),t}}async function g(){const e=await fetch("/api/auth/whoAmI",{method:"get",credentials:"include"});try{return await e.json()}catch(t){return console.log(t),t}}export{j as default};
